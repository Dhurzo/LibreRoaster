# Requirements Archive: v1.2 Artisan integration polish

**Archived:** 2026-02-04
**Status:** ✅ SHIPPED

This is the archived requirements specification for v1.2.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

# Requirements: LibreRoaster v1.2 Artisan integration polish

**Defined:** 2026-02-04
**Core Value:** Artisan can read temperatures and control heater/fan during a roast session.

## v1 Requirements (this milestone)

### Command Coverage (harden existing handlers)

- [x] **CMD-01**: READ command (already implemented) outputs required telemetry fields with deterministic columns/precision; verified in tests with no missing/extra fields.
- [x] **CMD-02**: START command (already implemented) is idempotent, toggles session/streaming correctly, and is verified via tests.
- [x] **CMD-03**: STOP command (already implemented) is idempotent, stops streaming/outputs, and resets to safe state; verified via tests.
- [x] **CMD-04**: OT1 setpoint (already implemented) enforces 0–100% bounds; out-of-range/malformed payloads return explicit error/NAK and leave outputs unchanged.
- [x] **CMD-05**: IO3 setpoint (already implemented) enforces 0–100% bounds; out-of-range/malformed payloads return explicit error/NAK and leave outputs unchanged.
- [x] **CMD-06**: Unknown or unsupported commands return explicit error/NAK with no side effects.

### Formatter Compliance

- [x] **FMT-01**: Formatter outputs deterministic numeric precision, separators, and CRLF termination for READ and other responses, covering normal and boundary values.
- [x] **FMT-02**: Error responses use a consistent schema (code/message) and never clamp silently; invalid inputs produce stable, parseable output.

### Integration Tests (mock UART)

- [x] **INT-01**: End-to-end mock UART tests cover success paths for READ, START, STOP, OT1, and IO3, asserting responses and state transitions.
- [x] **INT-02**: End-to-end mock UART tests cover error paths (unknown commands, out-of-range/malformed setpoints) asserting no side effects.
- [x] **INT-03**: Start→command→stop sequences verified to ensure streaming toggles correctly and outputs reset to safe state on STOP.

## Future Requirements (later milestones)

### Extended Command Coverage

- **CMDX-01**: Implement remaining Artisan/Artisan+ commands beyond READ/START/STOP/OT1/IO3 with explicit errors.
- **CMDX-02**: Add feature-flagged protocol extensions without breaking Artisan compatibility.

### Hardening & Diagnostics

- **FMTX-01**: Golden/snapshot tests for all formatter outputs across commands and edge values.
- **INTX-01**: Timing/jitter tolerance tests for USB-serial backpressure and latency scenarios.
- **DIAG-01**: Structured diagnostics with verbosity controls for parser/dispatcher/formatter.
- **SAFE-01**: Configurable per-channel safety caps above global bounds.

## Out of Scope (explicit exclusions for this milestone)

| Feature | Reason |
|---------|--------|
| Full Artisan/Artisan+ command set beyond core commands | Deferred to future to keep scope tight |
| Timing/jitter tolerance test suite | Deferred; prioritize baseline integration first |
| Formatter golden snapshot suite | Deferred; deterministic formatting verified functionally this milestone |
| Diagnostics verbosity and logs | Deferred to avoid scope creep |
| Per-channel safety caps | Deferred; keep behavior aligned to current bounds |
| Hardware validation on ESP32-C3 | Host-side only this milestone; hardware follow-up later |

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| CMD-01 | Phase 8 | Complete |
| CMD-02 | Phase 8 | Complete |
| CMD-03 | Phase 8 | Complete |
| CMD-04 | Phase 8 | Complete |
| CMD-05 | Phase 8 | Complete |
| CMD-06 | Phase 8 | Complete |
| FMT-01 | Phase 9 | Complete |
| FMT-02 | Phase 9 | Complete |
| INT-01 | Phase 10 | Complete |
| INT-02 | Phase 10 | Complete |
| INT-03 | Phase 10 | Complete |

**Coverage:**
- v1 requirements: 11 total
- Mapped to phases: 11
- Unmapped: 0 ✓

---

## Milestone Summary

**Shipped:** 11 of 11 v1 requirements
**Adjusted:** None
**Dropped:** None

---

*Archived: 2026-02-04 as part of v1.2 milestone completion*
