# Milestone v1.5: Serial Protocol Implementation

**Status:** ✅ SHIPPED 2026-02-04
**Phases:** 17-18
**Total Plans:** 2

## Overview

Implement full Artisan serial protocol for ESP32-C3 firmware. Enables Artisan coffee roasting software to read temperatures and control heater/fan via serial connection.

## Phases

### Phase 17: Initialization Handshake

**Goal:** System responds to Artisan initialization sequence with correct acknowledgments.

**Plans:**

- [x] 17-01: Initialization handshake implementation

**Details:**
- CHAN→UNITS→FILT handshake with `#` acknowledgment
- Semicolon delimiter support (`CHAN;1200`, `UNITS;C`, `FILT;5`)
- InitState machine: Idle → ExpectingChan → ExpectingUnits → ExpectingFilt → Ready
- ACK/ERR formatting (`format_chan_ack()`, `format_err()`)
- 47+ unit tests

### Phase 18: Command & Response Protocol

**Goal:** System executes READ, control, and error commands per Artisan specification.

**Plans:**

- [x] 18-01: Command & Response Protocol implementation

**Details:**
- READ command: 7-value response (`ET,BT,ET2,BT2,ambient,fan,heater\r\n`)
- UP/DOWN commands: 5% increments with clamping at 0/100
- OT1/IO3 control with bounds checking
- ERR response format (`ERR {code} {message}`)
- Parser recovery for partial commands
- 275 lines of comprehensive tests

---

## Key Decisions

- Phase structure: Foundation (handshake) → Operations (commands) for clear dependency boundary
- UP/DOWN clamping: No error at boundaries, just clamp value
- Unused READ channels: Return `-1` (not `0`) per Artisan spec

## Technical Debt

- Tests require x86_64 target to run (no_std embedded environment)
- Minor unused import warning in build

---

_For current project status, see .planning/ROADMAP.md_
